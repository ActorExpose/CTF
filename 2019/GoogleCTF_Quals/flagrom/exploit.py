from pwn import *
from itertools import product
import hashlib
import string

#context.log_level = 'debug'

with open('usercode.bin', 'rb') as f:
    usercode = f.read()

p = remote('flagrom.ctfcompetition.com', 1337)

pow_plain_prefix = "flagrom-"
pow_md5_prefix = p.recvline().strip()[-7:-1]

print('Solving POW with target prefix ' + pow_md5_prefix)
for suffix in product(string.printable, repeat = 8):
    pow_answer = pow_plain_prefix + ''.join(suffix)
    pow_md5 = hashlib.md5(pow_answer).hexdigest()
    if pow_md5[:6] == pow_md5_prefix:
        print('pow_answer: ' + pow_answer)
        print('pow_md5: ' + pow_md5)
        break

p.sendline(pow_answer)

p.recvline()
p.sendline(str(len(usercode)))
p.send(usercode)

p.interactive()